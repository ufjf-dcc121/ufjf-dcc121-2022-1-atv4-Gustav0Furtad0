<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Problema do Fazendeiro - ATV4</title>
    <link rel="stylesheet" href="./css/style.css">
</head>
<body>
    <div class="rio">
        <div class="margem" id="maresquerda">
            <div id="ovelha">
                
            </div>
            <div id="alface">
                
            </div>
            <div id="lobo">
                  
            </div>
        </div>

        <div class="margem" id="mardireita">

        </div>

        <div id="fazendeiro">
            <div id="bau">
                
            </div>
        </div>
        
    </div>

    <script>
        const fazendeiro = document.querySelector("#fazendeiro");
        const ovelha = document.querySelector("#ovelha");
        const lobo = document.querySelector("#lobo");
        const alface = document.querySelector("#alface");
        const maresquerda = document.querySelector("#maresquerda");
        const mardireita = document.querySelector("#mardireita");
        const bau = document.querySelector("#bau")

        function move(elemento, inicio, fim) {
            if (inicio < fim) {
                let i = inicio + 1;
                setTimeout(() => {
                    elemento.style.left = i + 'px';
                    move(elemento, i, fim);
                }, 4);
            } else if (inicio > fim) {
                let i = inicio - 1;
                setTimeout(() => {
                    elemento.style.left = i + 'px';
                    move(elemento, i, fim);
                }, 4);
            }
        }

        function entraSaiBarco(elemento) {
            let fazend = fazendeiro.getBoundingClientRect();
            let maresq = maresquerda.getBoundingClientRect();
            let mardir = mardireita.getBoundingClientRect();
            let copia = elemento.outerHTML;
            if(elemento.parentNode == maresquerda && fazend.left == maresq.right) {
                console.log("lobinho na esquerda")
                elemento.remove();
                bau.innerHTML = copia;
                bau.querySelector("#ovelha").addEventListener("click", ()=>{
                    console.log("ovelha dolly clicada");
                })
            } else if(elemento.parentNode == mardireita && fazend.left == (mardir.left - 450)) {
                console.log("lobinho na direita")
                elemento.remove();
                
            } else if (elemento.parentNode == bau){
                console.log("Nada aqui")
            }
        }

        function margens() {
            console.log(fazendeiro.getBoundingClientRect());
            console.log(maresquerda.getBoundingClientRect());
            console.log(mardireita.getBoundingClientRect());
        }

        fazendeiro.addEventListener("click", (e) => {
            console.log("clicou no fazendeiro");
            let fazend = fazendeiro.getBoundingClientRect();
            let maresq = maresquerda.getBoundingClientRect();
            let mardir = mardireita.getBoundingClientRect();
            console.log(fazend.left);
            if (fazend.left == maresq.right) {
                move(fazendeiro, fazend.left, (mardir.left - 450));
                fazendeiro.style.transform = 'scaleX(1)';
            } else if (fazend.right == mardir.left) {
                move(fazendeiro, fazend.left, maresq.right);
                fazendeiro.style.transform = 'scaleX(-1)';
            } 
        });

        lobo.addEventListener("click", () => {
            entraSaiBarco(lobo);
        });

        ovelha.addEventListener("click", (e) => {
            console.log("Ovelha clicada");
            e.stopPropagation();
            entraSaiBarco(ovelha);
        });

        alface.addEventListener("click", () => {
            entraSaiBarco(alface);
        });
        
    </script>
</body>
</html>